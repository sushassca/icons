<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>.icons</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <!-- STYLES -->
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="master.css">
  <style media="screen">
  #camera-stream {
position: absolute;
width: 100%;
height: 100%;
}

#flip-btn {
position: absolute;
bottom: 10px;
right: 10px;
padding: 10px 20px;

}
  </style>
</head>

<body>
  <video id="camera-stream"></video>
     <button disabled id="flip-btn">
       Flip Camera
     </button>
  <!-- SCRIPTS -->

  <script type="text/javascript">
  / camera stream video element
let videoElm = document.querySelector('#camera-stream');
// flip button element
let flipBtn = document.querySelector('#flip-btn');

// default user media options
let defaultsOpts = { audio: false, video: true }
let shouldFaceUser = true;

// check whether we can use facingMode
let supports = navigator.mediaDevices.getSupportedConstraints();
if( supports['facingMode'] === true ) {
  flipBtn.disabled = false;
}

let stream = null;

function capture() {
  defaultsOpts.video = { facingMode: shouldFaceUser ? 'user' : 'environment' }
  navigator.mediaDevices.getUserMedia(defaultsOpts)
    .then(function(_stream) {
      stream  = _stream;
      videoElm.srcObject = stream;
      videoElm.play();
    })
    .catch(function(err) {
      console.log(err)
    });
}

flipBtn.addEventListener('click', function(){
  if( stream == null ) return
  // we need to flip, stop everything
  stream.getTracks().forEach(t => {
    t.stop();
  });
  // toggle / flip
  shouldFaceUser = !shouldFaceUser;
  capture();
})

capture();
  </script>
</body>

</html>
